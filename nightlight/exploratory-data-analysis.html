<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Exploratory data analysis | Exploring Nighttime Light in the U.S. Southeast</title>
  <meta name="description" content="2 Exploratory data analysis | Exploring Nighttime Light in the U.S. Southeast" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Exploratory data analysis | Exploring Nighttime Light in the U.S. Southeast" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Exploratory data analysis | Exploring Nighttime Light in the U.S. Southeast" />
  
  
  

<meta name="author" content="Daniel Moul" />


<meta name="date" content="2021-09-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="modeling-and-model-comparison.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://dmoul.github.io/nightlight/introduction.html target="_blank">Exploring Nighttime Light</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#questions"><i class="fa fa-check"></i><b>1.1</b> Questions</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#method"><i class="fa fa-check"></i><b>1.2</b> Method</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#causal-assumptions"><i class="fa fa-check"></i><b>1.3</b> Causal assumptions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>2</b> Exploratory data analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#map"><i class="fa fa-check"></i><b>2.1</b> Map</a></li>
<li class="chapter" data-level="2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-for-modeling"><i class="fa fa-check"></i><b>2.2</b> Data for modeling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#predictors-and-data-transformations"><i class="fa fa-check"></i><b>2.2.1</b> Predictors and data transformations</a></li>
<li class="chapter" data-level="2.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#radiance-values-distribution-by-state"><i class="fa fa-check"></i><b>2.2.2</b> Radiance values’ distribution by state</a></li>
<li class="chapter" data-level="2.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#r2-and-linear-relationships-slope-estimates-by-state"><i class="fa fa-check"></i><b>2.2.3</b> <span class="math inline">\(R^2\)</span> and linear relationships: slope estimates by state</a></li>
<li class="chapter" data-level="2.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#eda-summary-comments"><i class="fa fa-check"></i><b>2.2.4</b> EDA summary comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html"><i class="fa fa-check"></i><b>3</b> Modeling and model comparison</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#train-and-test-on-training-data-set"><i class="fa fa-check"></i><b>3.1</b> Train and test on training data set</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#lin1-pop_density-light_avg"><i class="fa fa-check"></i><b>3.1.1</b> lin1: pop_density ~ light_avg</a></li>
<li class="chapter" data-level="3.1.2" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#lin2-pop_density_official-light_avg"><i class="fa fa-check"></i><b>3.1.2</b> lin2: pop_density_official ~ light_avg</a></li>
<li class="chapter" data-level="3.1.3" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#lin3-log_pop_density-log_light_avg"><i class="fa fa-check"></i><b>3.1.3</b> lin3: log_pop_density ~ log_light_avg</a></li>
<li class="chapter" data-level="3.1.4" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#pol1-log_light_avg-polylog_pop_density-2"><i class="fa fa-check"></i><b>3.1.4</b> pol1: log_light_avg ~ poly(log_pop_density, 2)</a></li>
<li class="chapter" data-level="3.1.5" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#lme1-multi-level-model-with-lme4lmer"><i class="fa fa-check"></i><b>3.1.5</b> lme1: multi-level model with <span>lme4::lmer</span></a></li>
<li class="chapter" data-level="3.1.6" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#bs1-linear-model-with-b-spline"><i class="fa fa-check"></i><b>3.1.6</b> bs1: linear model with b-spline</a></li>
<li class="chapter" data-level="3.1.7" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#xgboost-log_pop_density-log_light_avg-state"><i class="fa fa-check"></i><b>3.1.7</b> XGBoost: log_pop_density ~ log_light_avg + state</a></li>
<li class="chapter" data-level="3.1.8" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#summary-of-train-test-results"><i class="fa fa-check"></i><b>3.1.8</b> Summary of train-test results</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#assessing-model-performance-with-the-holdout-data-set"><i class="fa fa-check"></i><b>3.2</b> Assessing model performance with the holdout data set</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#summary-model-evaluation-using-holdout-data-set"><i class="fa fa-check"></i><b>3.2.1</b> Summary: model evaluation using holdout data set</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#comparing-2000-and-2010"><i class="fa fa-check"></i><b>3.3</b> Comparing 2000 and 2010</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="modeling-and-model-comparison.html"><a href="modeling-and-model-comparison.html#summary-model-performance-on-census-2010-data."><i class="fa fa-check"></i><b>3.3.1</b> Summary: model performance on census 2010 data.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="interpreting-the-results.html"><a href="interpreting-the-results.html"><i class="fa fa-check"></i><b>4</b> Interpreting the results</a>
<ul>
<li class="chapter" data-level="4.1" data-path="interpreting-the-results.html"><a href="interpreting-the-results.html#how-much-did-the-population-density-and-radiance-change-between-2000-and-2010"><i class="fa fa-check"></i><b>4.1</b> How much did the population density and radiance change between 2000 and 2010?</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="interpreting-the-results.html"><a href="interpreting-the-results.html#from-2000-to-2010-radiance-increased-almost-twice-as-much-as-population-density"><i class="fa fa-check"></i><b>4.1.1</b> From 2000 to 2010 radiance increased almost twice as much as population density</a></li>
<li class="chapter" data-level="4.1.2" data-path="interpreting-the-results.html"><a href="interpreting-the-results.html#exploring-changes-in-radiance-and-population-density-2000-and-2010"><i class="fa fa-check"></i><b>4.1.2</b> Exploring changes in radiance and population density 2000 and 2010</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="interpreting-the-results.html"><a href="interpreting-the-results.html#conclusion"><i class="fa fa-check"></i><b>4.2</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="end-notes.html"><a href="end-notes.html"><i class="fa fa-check"></i><b>5</b> End notes</a>
<ul>
<li class="chapter" data-level="5.1" data-path="end-notes.html"><a href="end-notes.html#acknowlegements"><i class="fa fa-check"></i><b>5.1</b> Acknowlegements</a></li>
<li class="chapter" data-level="5.2" data-path="end-notes.html"><a href="end-notes.html#data-provenance"><i class="fa fa-check"></i><b>5.2</b> Data provenance</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="end-notes.html"><a href="end-notes.html#version-4-dmsp-ols-nighttime-lights-time-series"><i class="fa fa-check"></i><b>5.2.1</b> Version 4 DMSP-OLS Nighttime Lights Time Series</a></li>
<li class="chapter" data-level="5.2.2" data-path="end-notes.html"><a href="end-notes.html#radiance-data"><i class="fa fa-check"></i><b>5.2.2</b> Radiance data</a></li>
<li class="chapter" data-level="5.2.3" data-path="end-notes.html"><a href="end-notes.html#intercalibration"><i class="fa fa-check"></i><b>5.2.3</b> Intercalibration</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="end-notes.html"><a href="end-notes.html#assumptions-and-limitations"><i class="fa fa-check"></i><b>5.3</b> Assumptions and limitations</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="end-notes.html"><a href="end-notes.html#limitations"><i class="fa fa-check"></i><b>5.3.1</b> Limitations</a></li>
<li class="chapter" data-level="5.3.2" data-path="end-notes.html"><a href="end-notes.html#census-data-and-state-and-county-geometry"><i class="fa fa-check"></i><b>5.3.2</b> Census data and state and county geometry</a></li>
<li class="chapter" data-level="5.3.3" data-path="end-notes.html"><a href="end-notes.html#population-and-population-density"><i class="fa fa-check"></i><b>5.3.3</b> Population and population density</a></li>
<li class="chapter" data-level="5.3.4" data-path="end-notes.html"><a href="end-notes.html#economic-development-gdp-business-cycle"><i class="fa fa-check"></i><b>5.3.4</b> Economic development / GDP / business cycle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="end-notes.html"><a href="end-notes.html#project-organization"><i class="fa fa-check"></i><b>5.4</b> Project organization</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="end-notes.html"><a href="end-notes.html#data-preparation-pipeline-implemented-to-with-targets-package"><i class="fa fa-check"></i><b>5.4.1</b> Data preparation pipeline implemented to with targets package</a></li>
<li class="chapter" data-level="5.4.2" data-path="end-notes.html"><a href="end-notes.html#session-information"><i class="fa fa-check"></i><b>5.4.2</b> Session information</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://dmoul.github.io" target="_blank">By Daniel Moul</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring Nighttime Light in the U.S. Southeast</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploratory-data-analysis" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Exploratory data analysis</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="exploratory-data-analysis.html#cb2-1" aria-hidden="true" tabindex="-1"></a>c_focus <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(census_focus_df)</span>
<span id="cb2-2"><a href="exploratory-data-analysis.html#cb2-2" aria-hidden="true" tabindex="-1"></a>county_boundaries_terra <span class="ot">&lt;-</span> <span class="fu">as</span>(<span class="fu">tar_read</span>(census_focus_df),<span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb2-3"><a href="exploratory-data-analysis.html#cb2-3" aria-hidden="true" tabindex="-1"></a>state_boundaries_terra <span class="ot">&lt;-</span> <span class="fu">as</span>(<span class="fu">tar_read</span>(state_boundaries_geom),<span class="st">&quot;Spatial&quot;</span>)</span>
<span id="cb2-4"><a href="exploratory-data-analysis.html#cb2-4" aria-hidden="true" tabindex="-1"></a>state_list <span class="ot">&lt;-</span> <span class="fu">glue_collapse</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(c_focus<span class="sc">$</span>state)), <span class="at">sep =</span> <span class="st">&#39;, &#39;</span>, <span class="at">last =</span> <span class="st">&quot; and &quot;</span>)</span></code></pre></div>
<div id="map" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Map</h2>
<p>Specifically, I look at the 859 counties in 9 states: AL, GA, KY, MS, NC, SC, TN, VA and WV. It’s interesting to note that in nearly every county there is one main spot of light. Typically this city or town is the county seat of government and locus of economic activity. Radiance values span a wider range than this visible image suggests.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="exploratory-data-analysis.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># following the pattern at https://rspatial.org/terra/rs/2-exploration.html</span></span>
<span id="cb3-2"><a href="exploratory-data-analysis.html#cb3-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">rast</span>(source_light_file_2000)</span>
<span id="cb3-3"><a href="exploratory-data-analysis.html#cb3-3" aria-hidden="true" tabindex="-1"></a>my_bbox <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(bbox_vec)</span>
<span id="cb3-4"><a href="exploratory-data-analysis.html#cb3-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">ext</span>(<span class="fu">as.numeric</span>(<span class="fu">c</span>(my_bbox<span class="sc">$</span>xmin, my_bbox<span class="sc">$</span>xmax, my_bbox<span class="sc">$</span>ymin, my_bbox<span class="sc">$</span>ymax)))</span>
<span id="cb3-5"><a href="exploratory-data-analysis.html#cb3-5" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">crop</span>(f1, e)</span>
<span id="cb3-6"><a href="exploratory-data-analysis.html#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="exploratory-data-analysis.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plotRGB</span>(f2, <span class="at">r =</span> <span class="dv">1</span>, <span class="at">g =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">255</span>, <span class="at">stretch =</span> <span class="st">&quot;lin&quot;</span>)</span>
<span id="cb3-8"><a href="exploratory-data-analysis.html#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(county_boundaries_terra, <span class="at">border =</span> <span class="st">&quot;#fffdd0&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.25</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co"># cream color</span></span>
<span id="cb3-9"><a href="exploratory-data-analysis.html#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(state_boundaries_terra, <span class="at">border =</span> <span class="st">&quot;#fffdd0&quot;</span>, <span class="at">add =</span> <span class="cn">TRUE</span>) <span class="co"># cream color</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:se-us-map"></span>
<img src="02-eda_files/figure-html/se-us-map-1.png" alt="Average nightlight in the S.E. United States in 2000" width="672" />
<p class="caption">
Figure 2.1: Average nightlight in the S.E. United States in 2000
</p>
</div>
<p><br></p>
</div>
<div id="data-for-modeling" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Data for modeling</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="exploratory-data-analysis.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># models_df &lt;- tar_read(models)</span></span>
<span id="cb4-2"><a href="exploratory-data-analysis.html#cb4-2" aria-hidden="true" tabindex="-1"></a>data_df <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(all_df) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="exploratory-data-analysis.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fix NAs</span></span>
<span id="cb4-4"><a href="exploratory-data-analysis.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">atotal =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(atotal), atotal, calc_area),</span>
<span id="cb4-5"><a href="exploratory-data-analysis.html#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop_density_official =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(pop_density_official), pop_density_official, pop_density)) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="exploratory-data-analysis.html#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># drop a small number of apparent data errors</span></span>
<span id="cb4-7"><a href="exploratory-data-analysis.html#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(light_avg <span class="sc">&gt;</span> <span class="fl">1e-5</span>)</span>
<span id="cb4-8"><a href="exploratory-data-analysis.html#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="exploratory-data-analysis.html#cb4-9" aria-hidden="true" tabindex="-1"></a>county_light_sf <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(county_sf)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="exploratory-data-analysis.html#cb5-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="ot">&lt;-</span> data_df <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="exploratory-data-analysis.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(state<span class="sc">:</span>pop_density_official) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="exploratory-data-analysis.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area_diff_pct =</span> calc_area <span class="sc">/</span> atotal <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb5-4"><a href="exploratory-data-analysis.html#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">pop_densisty_diff_pct =</span> pop_density <span class="sc">/</span> pop_density_official <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<div id="predictors-and-data-transformations" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Predictors and data transformations</h3>
<p>I have a plausible causal conjecture for two easily accessible variables associated with “human presence” such that we can use radiance to predict them:</p>
<ul>
<li><code>pop_density</code>: the more people that live in a unit area, the more built out the area will be; the more built out an area is, the more light generated in that area</li>
<li><code>medincome</code>: the wealthier people are, the more light they will generate</li>
</ul>
<p><code>pop_density</code> and <code>medincome</code> likely are correlated, so I may use only one of them.</p>
<p>Since associations are reflexive, we can work from the data we have (predictor(s)) to the outcome we seek (response). In this case: using light to predict population density.</p>
<p>In the plots below, the blue line is a <a href="https://en.wikipedia.org/wiki/Local_regression">LOESS curve</a> (locally estimated scatterplot smoothing), the red line a straight regression line.</p>
<p>Figures <a href="exploratory-data-analysis.html#fig:pop-density-light-avg-scatter">2.2</a> to <a href="exploratory-data-analysis.html#fig:pop-density-light-avg-loglog-facet-scatter">2.5</a> show that <code>light_avg</code> and <code>pop_density</code> work best on a log scale.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="exploratory-data-analysis.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># light as predictor</span></span>
<span id="cb6-2"><a href="exploratory-data-analysis.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="exploratory-data-analysis.html#cb6-3" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="exploratory-data-analysis.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="exploratory-data-analysis.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(light_avg, pop_density, <span class="at">color =</span> state), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="exploratory-data-analysis.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, pop_density, ), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="exploratory-data-analysis.html#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, pop_density, ), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb6-8"><a href="exploratory-data-analysis.html#cb6-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="exploratory-data-analysis.html#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span> </span>
<span id="cb6-10"><a href="exploratory-data-analysis.html#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;pop_density by light_avg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:pop-density-light-avg-scatter"></span>
<img src="02-eda_files/figure-html/pop-density-light-avg-scatter-1.png" alt="light_avg by pop_density (all states)" width="672" />
<p class="caption">
Figure 2.2: light_avg by pop_density (all states)
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="exploratory-data-analysis.html#cb7-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="exploratory-data-analysis.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(light_avg, pop_density)) <span class="sc">+</span></span>
<span id="cb7-3"><a href="exploratory-data-analysis.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="exploratory-data-analysis.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="exploratory-data-analysis.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb7-6"><a href="exploratory-data-analysis.html#cb7-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="exploratory-data-analysis.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span> </span>
<span id="cb7-8"><a href="exploratory-data-analysis.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)<span class="sc">+</span></span>
<span id="cb7-9"><a href="exploratory-data-analysis.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;pop_density by light_avg&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:pop-density-light-avg-facet-scatter"></span>
<img src="02-eda_files/figure-html/pop-density-light-avg-facet-scatter-1.png" alt="light_avg by pop_density (faceted by state)" width="672" />
<p class="caption">
Figure 2.3: light_avg by pop_density (faceted by state)
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="exploratory-data-analysis.html#cb8-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="exploratory-data-analysis.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="exploratory-data-analysis.html#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(light_avg, pop_density, <span class="at">color =</span> state), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-4"><a href="exploratory-data-analysis.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, pop_density), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="exploratory-data-analysis.html#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, pop_density),</span>
<span id="cb8-6"><a href="exploratory-data-analysis.html#cb8-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb8-7"><a href="exploratory-data-analysis.html#cb8-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-8"><a href="exploratory-data-analysis.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb8-9"><a href="exploratory-data-analysis.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span></span>
<span id="cb8-10"><a href="exploratory-data-analysis.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;log_light_avg by log_pop_density&quot;</span>,</span>
<span id="cb8-11"><a href="exploratory-data-analysis.html#cb8-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;pop_density (log10 scale)&quot;</span>,</span>
<span id="cb8-12"><a href="exploratory-data-analysis.html#cb8-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;light_avg (log10 scale)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:pop-density-light-avg-loglog-scatter"></span>
<img src="02-eda_files/figure-html/pop-density-light-avg-loglog-scatter-1.png" alt="log_light_avg by log_pop_density (all states)" width="672" />
<p class="caption">
Figure 2.4: log_light_avg by log_pop_density (all states)
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="exploratory-data-analysis.html#cb9-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="exploratory-data-analysis.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(light_avg, pop_density)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="exploratory-data-analysis.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="exploratory-data-analysis.html#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-5"><a href="exploratory-data-analysis.html#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb9-6"><a href="exploratory-data-analysis.html#cb9-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="exploratory-data-analysis.html#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb9-8"><a href="exploratory-data-analysis.html#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span></span>
<span id="cb9-9"><a href="exploratory-data-analysis.html#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)<span class="sc">+</span></span>
<span id="cb9-10"><a href="exploratory-data-analysis.html#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;log_light_avg by log_pop_density&quot;</span>,</span>
<span id="cb9-11"><a href="exploratory-data-analysis.html#cb9-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;pop_density (log10 scale)&quot;</span>,</span>
<span id="cb9-12"><a href="exploratory-data-analysis.html#cb9-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;light_avg (log10 scale)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:pop-density-light-avg-loglog-facet-scatter"></span>
<img src="02-eda_files/figure-html/pop-density-light-avg-loglog-facet-scatter-1.png" alt="log_light_avg by log_pop_density (faceted by state)" width="672" />
<p class="caption">
Figure 2.5: log_light_avg by log_pop_density (faceted by state)
</p>
</div>
<p><br></p>
<p>Figures <a href="exploratory-data-analysis.html#fig:medincome-light-avg-scatterplot">2.6</a> to <a href="exploratory-data-analysis.html#fig:medincome-light-avg-facet-scatterplot">2.8</a> show that <code>medincome</code> also works best on a log scale.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="exploratory-data-analysis.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median income as predictor</span></span>
<span id="cb10-2"><a href="exploratory-data-analysis.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="exploratory-data-analysis.html#cb10-3" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="exploratory-data-analysis.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb10-5"><a href="exploratory-data-analysis.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(light_avg, medincome, <span class="at">color =</span> state), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="exploratory-data-analysis.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, medincome), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-7"><a href="exploratory-data-analysis.html#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, medincome), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb10-8"><a href="exploratory-data-analysis.html#cb10-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="exploratory-data-analysis.html#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span> </span>
<span id="cb10-10"><a href="exploratory-data-analysis.html#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_log10() +</span></span>
<span id="cb10-11"><a href="exploratory-data-analysis.html#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~state)+</span></span>
<span id="cb10-12"><a href="exploratory-data-analysis.html#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;medincome by light_avg&quot;</span>,</span>
<span id="cb10-13"><a href="exploratory-data-analysis.html#cb10-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">glue</span>(<span class="st">&quot;correlation: {round(cor(d_df$pop_density, d_df$medincome), 2)}&quot;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:medincome-light-avg-scatterplot"></span>
<img src="02-eda_files/figure-html/medincome-light-avg-scatterplot-1.png" alt="light_avg by medincome (all states)" width="672" />
<p class="caption">
Figure 2.6: light_avg by medincome (all states)
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="exploratory-data-analysis.html#cb11-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="exploratory-data-analysis.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb11-3"><a href="exploratory-data-analysis.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(light_avg, medincome, <span class="at">color =</span> state), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="exploratory-data-analysis.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, medincome), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-5"><a href="exploratory-data-analysis.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(light_avg, medincome), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb11-6"><a href="exploratory-data-analysis.html#cb11-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="exploratory-data-analysis.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb11-8"><a href="exploratory-data-analysis.html#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span></span>
<span id="cb11-9"><a href="exploratory-data-analysis.html#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;log_medincome by log_light_avg&quot;</span>,</span>
<span id="cb11-10"><a href="exploratory-data-analysis.html#cb11-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;medincome (log10 scale)&quot;</span>,</span>
<span id="cb11-11"><a href="exploratory-data-analysis.html#cb11-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;light_avg (log10 scale)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:medincome-light-avg-loglog-scatterplot"></span>
<img src="02-eda_files/figure-html/medincome-light-avg-loglog-scatterplot-1.png" alt="log_light_avg by log_medincome (all states)" width="672" />
<p class="caption">
Figure 2.7: log_light_avg by log_medincome (all states)
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="exploratory-data-analysis.html#cb12-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="exploratory-data-analysis.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(light_avg, medincome)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="exploratory-data-analysis.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="exploratory-data-analysis.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="exploratory-data-analysis.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb12-6"><a href="exploratory-data-analysis.html#cb12-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="exploratory-data-analysis.html#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="exploratory-data-analysis.html#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_y_log10() +</span></span>
<span id="cb12-9"><a href="exploratory-data-analysis.html#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)<span class="sc">+</span></span>
<span id="cb12-10"><a href="exploratory-data-analysis.html#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;light_avg by medincome&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:medincome-light-avg-facet-scatterplot"></span>
<img src="02-eda_files/figure-html/medincome-light-avg-facet-scatterplot-1.png" alt="light_avg by medincome (faceted by state)" width="672" />
<p class="caption">
Figure 2.8: light_avg by medincome (faceted by state)
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exploratory-data-analysis.html#cb13-1" aria-hidden="true" tabindex="-1"></a>d_df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="exploratory-data-analysis.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(light_avg, medincome)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="exploratory-data-analysis.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="exploratory-data-analysis.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-5"><a href="exploratory-data-analysis.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>,</span>
<span id="cb13-6"><a href="exploratory-data-analysis.html#cb13-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="exploratory-data-analysis.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span> </span>
<span id="cb13-8"><a href="exploratory-data-analysis.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number_si</span>()) <span class="sc">+</span></span>
<span id="cb13-9"><a href="exploratory-data-analysis.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>state)<span class="sc">+</span></span>
<span id="cb13-10"><a href="exploratory-data-analysis.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;log_medincome by log_light_avg&quot;</span>,</span>
<span id="cb13-11"><a href="exploratory-data-analysis.html#cb13-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;medincome (log10 scale)&quot;</span>,</span>
<span id="cb13-12"><a href="exploratory-data-analysis.html#cb13-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;light_avg (log10 scale)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:medincome-light-avg-loglog-facet-scatterplot"></span>
<img src="02-eda_files/figure-html/medincome-light-avg-loglog-facet-scatterplot-1.png" alt="log_light_avg by log_medincome (faceted by state)" width="672" />
<p class="caption">
Figure 2.9: log_light_avg by log_medincome (faceted by state)
</p>
</div>
<p><br></p>
<p><code>pop_density</code> and <code>medincome</code> are correlated (corr = 0.35) but less so for states with big urban areas (especially VA). Since they are correlated, and my goal is to check whether we can associate radiance levels with a demographic change, it’s best if I include only one models. Since <code>pop_density</code> ~ <code>light_avg</code> (corr = 0.94) has less variance than <code>pop_density</code> ~ <code>light_avg</code> (corr = 0.37).</p>
<p><br></p>
</div>
<div id="radiance-values-distribution-by-state" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Radiance values’ distribution by state</h3>
<p>Each pixel has a light radiance value. Below are radiance values by state in a density plot (Figure <a href="exploratory-data-analysis.html#fig:radiance-density-2000">2.10</a>) and an empirical cumulative distribution (Figure <a href="exploratory-data-analysis.html#fig:radiance-ecdf-2000">2.11</a>) . The distributions are similar in shape. The most noticeable difference is that the portion of zero values (completely black pixels) differs by state.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="exploratory-data-analysis.html#cb14-1" aria-hidden="true" tabindex="-1"></a>county_light_sf <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="exploratory-data-analysis.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> value <span class="sc">+</span> <span class="fl">1e-6</span>,</span>
<span id="cb14-3"><a href="exploratory-data-analysis.html#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">state =</span> <span class="fu">fct_reorder</span>(state, value, median)) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="exploratory-data-analysis.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="at">color =</span> state)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="exploratory-data-analysis.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="exploratory-data-analysis.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb14-7"><a href="exploratory-data-analysis.html#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Radiance density&quot;</span>,</span>
<span id="cb14-8"><a href="exploratory-data-analysis.html#cb14-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;light value (log10 scale)&quot;</span>,</span>
<span id="cb14-9"><a href="exploratory-data-analysis.html#cb14-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:radiance-density-2000"></span>
<img src="02-eda_files/figure-html/radiance-density-2000-1.png" alt="Radiance density 2000" width="672" />
<p class="caption">
Figure 2.10: Radiance density 2000
</p>
</div>
<p><br></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exploratory-data-analysis.html#cb15-1" aria-hidden="true" tabindex="-1"></a>county_light_sf <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="exploratory-data-analysis.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">fct_reorder</span>(state, value, median)) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="exploratory-data-analysis.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, <span class="at">color =</span> state)) <span class="sc">+</span></span>
<span id="cb15-4"><a href="exploratory-data-analysis.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="at">pad =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-5"><a href="exploratory-data-analysis.html#cb15-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb15-6"><a href="exploratory-data-analysis.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb15-7"><a href="exploratory-data-analysis.html#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">label =</span> <span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb15-8"><a href="exploratory-data-analysis.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Radiance ECD&quot;</span>,</span>
<span id="cb15-9"><a href="exploratory-data-analysis.html#cb15-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;light value (log10 scale)&quot;</span>,</span>
<span id="cb15-10"><a href="exploratory-data-analysis.html#cb15-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:radiance-ecdf-2000"></span>
<img src="02-eda_files/figure-html/radiance-ecdf-2000-1.png" alt="Radiance empirical cumulative density 2000" width="672" />
<p class="caption">
Figure 2.11: Radiance empirical cumulative density 2000
</p>
</div>
<p><br></p>
</div>
<div id="r2-and-linear-relationships-slope-estimates-by-state" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> <span class="math inline">\(R^2\)</span> and linear relationships: slope estimates by state</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="exploratory-data-analysis.html#cb16-1" aria-hidden="true" tabindex="-1"></a>models_nested <span class="ot">&lt;-</span> d_df <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="exploratory-data-analysis.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_light_avg =</span> <span class="fu">log10</span>(light_avg),</span>
<span id="cb16-3"><a href="exploratory-data-analysis.html#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">log_pop_density =</span> <span class="fu">log10</span>(pop_density)) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="exploratory-data-analysis.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, log_pop_density, log_light_avg) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="exploratory-data-analysis.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state) <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="exploratory-data-analysis.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="exploratory-data-analysis.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(data, <span class="cf">function</span>(df) <span class="fu">lm</span>(log_pop_density <span class="sc">~</span> log_light_avg, <span class="at">data =</span> df)),</span>
<span id="cb16-8"><a href="exploratory-data-analysis.html#cb16-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">tidied =</span> <span class="fu">map</span>(model, tidy), </span>
<span id="cb16-9"><a href="exploratory-data-analysis.html#cb16-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">augmented =</span> <span class="fu">map</span>(model, broom<span class="sc">::</span>augment),</span>
<span id="cb16-10"><a href="exploratory-data-analysis.html#cb16-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">glanced =</span> <span class="fu">map</span>(model, broom<span class="sc">::</span>glance)</span>
<span id="cb16-11"><a href="exploratory-data-analysis.html#cb16-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-12"><a href="exploratory-data-analysis.html#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="exploratory-data-analysis.html#cb16-13" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">left_join</span>(tidied <span class="ot">&lt;-</span> models_nested <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="exploratory-data-analysis.html#cb16-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">unnest</span>(<span class="fu">c</span>(state, tidied)),</span>
<span id="cb16-15"><a href="exploratory-data-analysis.html#cb16-15" aria-hidden="true" tabindex="-1"></a>                adj_r_sqr <span class="ot">&lt;-</span> models_nested <span class="sc">%&gt;%</span></span>
<span id="cb16-16"><a href="exploratory-data-analysis.html#cb16-16" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">unnest</span>(<span class="fu">c</span>(state, glanced)) <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="exploratory-data-analysis.html#cb16-17" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">select</span>(state, adj.r.squared, sigma),</span>
<span id="cb16-18"><a href="exploratory-data-analysis.html#cb16-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">by =</span> <span class="st">&quot;state&quot;</span></span>
<span id="cb16-19"><a href="exploratory-data-analysis.html#cb16-19" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="exploratory-data-analysis.html#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>term <span class="sc">==</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="exploratory-data-analysis.html#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state, term, estimate, <span class="at">estimate_std.error =</span> std.error, adj.r.squared, <span class="at">adj.r.squared_sigma =</span> sigma) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="exploratory-data-analysis.html#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(adj.r.squared))</span>
<span id="cb16-23"><a href="exploratory-data-analysis.html#cb16-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-24"><a href="exploratory-data-analysis.html#cb16-24" aria-hidden="true" tabindex="-1"></a>state_levels <span class="ot">&lt;-</span> <span class="fu">rev</span>(models<span class="sc">$</span>state)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="exploratory-data-analysis.html#cb17-1" aria-hidden="true" tabindex="-1"></a>models <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="exploratory-data-analysis.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(estimate, adj.r.squared), <span class="at">names_to =</span> <span class="st">&quot;metric&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="exploratory-data-analysis.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">factor</span>(state, <span class="at">levels =</span> state_levels)) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="exploratory-data-analysis.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, state)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="exploratory-data-analysis.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="exploratory-data-analysis.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="exploratory-data-analysis.html#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb17-8"><a href="exploratory-data-analysis.html#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;R^2 and estimated slope of</span><span class="sc">\n</span><span class="st">lm(log_pop_density ~ log_light_avg)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:lm-r2-and-slope-estimate-by-state"></span>
<img src="02-eda_files/figure-html/lm-r2-and-slope-estimate-by-state-1.png" alt="R^2 and estimated slope of lm(log_light_avg ~ log_pop_density)" width="672" />
<p class="caption">
Figure 2.12: R^2 and estimated slope of lm(log_light_avg ~ log_pop_density)
</p>
</div>
<p><br></p>
</div>
<div id="eda-summary-comments" class="section level3" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> EDA summary comments</h3>
<p>The relationship between <span class="math inline">\(log_{10}(pop\_density)\)</span> and <span class="math inline">\(log_{10}(light\_avg)\)</span> in figures <a href="exploratory-data-analysis.html#fig:pop-density-light-avg-loglog-scatter">2.4</a> and <a href="exploratory-data-analysis.html#fig:pop-density-light-avg-loglog-facet-scatter">2.5</a>) isn’t quite linear, and there are differences by state. So I expect simple linear models to perform worse than more sophisticated ones. Nonetheless, I want to see how good linear models are, since they <em>are</em> simple and inexpensive.</p>

<!-- 03-modeling.Rmd -->
<!-- this is a child doc of index.Rmd -->
</div>
</div>
</div>
<div class="footer">
<hr />
<p>By Daniel Moul (heydanielmoul via gmail)</p>
<p><img src="https://i.creativecommons.org/l/by/4.0/88x31.png" alt="CC-BY" /> This work is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modeling-and-model-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
