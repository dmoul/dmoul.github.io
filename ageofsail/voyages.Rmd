---
title: "Some Voyages in the Age of Sail 1750-1815"
author: "Daniel Moul"
date: "2021-01-02"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 3
---

```{r setup, include=FALSE}

source(here::here("ageofsail/scripts", "setup.R"))

```

```{r create-world-and-water}
# World map example from https://www.simoncoulombe.com/2020/11/animated-ships/
  
world <- rnaturalearth::ne_countries(scale='medium',returnclass = 'sf')

# create water polygon for background 
lats <- c(90:-90, -90:90, 90)
longs <- c(rep(c(180, -180), each = 181), 180)
water_outline <- 
  list(cbind(longs, lats)) %>%
  st_polygon() %>%
  st_sfc(crs = "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs") %>% 
  st_sf()

```

```{r load-ports, include=FALSE}

ports_normalized <- read_csv(here("ageofsail/data", "ports-enriched4.csv")) %>%
  mutate( across(.cols = c(port2, level2, country), ~str_trim(str_to_lower(.x)) ) )
port_lon_lat <- read_csv(here("ageofsail/data", "port_lon_lat.csv")) %>%
  mutate( across(.cols = c(port2, level2, country), ~str_trim(str_to_lower(.x)) ) ) %>%
  filter(!is.na(port2))
df_ports <- left_join(ports_normalized, port_lon_lat, by = "port2") %>%
  mutate_if(is.character, ~map_chr(.x, iconv, "UTF-8", "UTF-8", sub='')) %>% # just in case
  mutate(level2 = coalesce(level2.x, level2.y),
         country = coalesce(country.x, country.y)) %>%
  select(-ends_with(c(".x", ".y")))

```

```{r load-voyages, include=FALSE}

# load df_voyages
source(here("ageofsail/scripts", "load-voyages.R"))

```

```{r load-functions, include=FALSE}

source(here("ageofsail/scripts", "string-collapse-function.R"))
source(here("ageofsail/scripts", "plot-voyages-functions.R"))

```

<br>
<br>

## Introduction

Two hundred and fifty years ago sailings ships were the engines of colonization and commerce. Where did they sail? How far and how long? We can gain some insight by making use of the Climatological Database for the World's Oceans (CLIWOC), which includes 287K observations from logbooks of `r nrow(count(all_voyages, ShipName))` ships from `r nrow(count(all_voyages, Nationality))` countries, mostly British, Dutch, French, and Spanish) that made `r nrow(count(all_voyages, ShipName, VoyageIni))` journeys. The digitized records are mostly from journeys between 1750 and 1850. These journey during this portion of the [Age of Sail](https://en.wikipedia.org/wiki/Age_of_Sail) influenced (and sometimes directly motivated) by these historical events: 

* [Seven years war](https://en.wikipedia.org/wiki/Seven_Years%27_War) (1756-1763) which included the [French and Indian War](https://en.wikipedia.org/wiki/French_and_Indian_War) in North America
* [American War of Independence](https://en.wikipedia.org/wiki/American_Revolutionary_War), [French Revolution](https://en.wikipedia.org/wiki/French_Revolution) and resulting [French Revolutionary Wars](https://en.wikipedia.org/wiki/French_Revolutionary_Wars), and others wars of independence in the Americas, including [Haiti](https://en.wikipedia.org/wiki/Haitian_Revolution), and the [Spanish American colonies](https://en.wikipedia.org/wiki/Spanish_American_wars_of_independence) (the latter continued beyond 1815 for many colonial lands)
* Voyages of discovery, including two by [James Cook](https://en.wikipedia.org/wiki/James_Cook)
* [Battle of Waterloo](https://en.wikipedia.org/wiki/Battle_of_Waterloo) and [Congress of Vienna](https://en.wikipedia.org/wiki/Congress_of_Vienna), bringing to end the [Napoleonic Wars](https://en.wikipedia.org/wiki/Napoleonic_Wars)
* The waxing preeminence of the British on the worlds' seas.

<br>

This data set only hints at the human drama: the strict and sometimes shockingly excessive punishment, the high mortality rate, the deprivations, and the near-unimaginable sufferings inherent in the slave trade. Or the triumphs of winning a hard-fought, costly battle, capturing an enemy ship, and, through many perils, bringing a fortune into one's home port. Historical fiction brings this period to life. I recommend Patrick O'Brian's Aubrey and Maturin series starting with [Master and Commander](https://en.wikipedia.org/wiki/Master_and_Commander). Or start with the movie [Master and Commander: The Far Side of the World](https://en.wikipedia.org/wiki/Master_and_Commander:_The_Far_Side_of_the_World), which conflates events from a number of the books.

<br>

### Nationality

After cleaning, the data set includes the following:

<br>

```{r some-summary-stats}

left_join(
  df_voyages %>%
    distinct(ShipName, Nationality) %>%
    count(Nationality, name = "n_ships", sort=TRUE),
  df_voyages %>%
    distinct(ShipName, VoyageIni, Nationality) %>%
    count(Nationality, name = "n_voyages", sort=TRUE),
  by = "Nationality"
  ) %>%
  left_join(
    .,
    df_voyages %>%
      group_by(Nationality) %>%
      summarize(n_observations = n()) %>%
      ungroup(),
    by = "Nationality"
  ) %>%
  left_join(
    .,
    df_voyages %>%
      group_by(Nationality, ShipName, VoyageIni) %>%
      summarize(n_days_enroute = max(n_days)) %>%
      ungroup() %>%
      group_by(Nationality) %>%
      summarize(n_days_enroute = sum(n_days_enroute)) %>%
      ungroup(),
    by = "Nationality"
  ) %>%
janitor::adorn_totals(where = "row") %>%
  gt() %>%
  fmt_number(
    columns = 2:5,
    decimals = 0,
    suffixing = FALSE
  ) %>%
  cols_align(
    align = "right",
    columns = 2:5
  )

```

<br>

```{r plot-nationalities-histogram, out.width="80%"}
 data_for_plot <- df_voyages %>%
  distinct(ShipName, Year, Nationality, color_route) %>% #VoyageIni, 
  mutate(Nationality = str_to_title(Nationality)) %>%
  # not enough data for the histogram
  filter(!Nationality %in% c("American", "Danish", "Hamburg", "Swedish")) 

data_for_plot_all <- data_for_plot %>% 
  select(-Nationality)

ggplot() +
  geom_histogram(data = data_for_plot_all,
                 aes(Year),
                 binwidth = 5,
                 fill = "lightslategrey", alpha = 0.3) +
  geom_histogram(data = data_for_plot,
                 aes(Year, fill = color_route),
                 binwidth = 5) +
  scale_x_continuous(breaks = c(1760, 1780, 1800)) +
  #scale_y_continuous(breaks = c(0, 200, 400)) +
  facet_wrap(~Nationality) +
  scale_fill_identity(labels = str_to_title(color_routes$Nationality),
                         breaks = color_routes$color_route,
                         guide = "legend") +
  theme(legend.position = "none") +
  labs(title = "Years in which there are observations",
       subtitle = glue("{min(data_for_plot_all$Year)} - {max(data_for_plot_all$Year)} in 5-year bins",
                       "\nCounting each ship and year in which observations were made"),
       x = "Year",
       y = "Count",
       caption = my_caption)


```

<br>

### Duration and distance

Unlike the land-bound, for sailors, the sea shore is the dangerous edge, and daily life happens on the seas, their medium of travel. Considered as a whole, most voyages in this data set lasted about seven weeks. Spanish and Dutch voyages were longest on average, since their colonial and commercial ties were further away; French ships' destinations were mostly closer to home in the North Atlantic and Caribbean.

<br>

```{r plot-duration-histogram, out.width="80%"}

HIST_BINWIDTH <- 7 # days

data_for_plot <- df_voyages %>%
  mutate(Nationality = str_to_title(Nationality)) %>%
  # not enough data for these countries to include them in the histogram
  filter(!Nationality %in% c("American", "Danish", "Hamburg", "Swedish")) 

my_median <- median(data_for_plot$n_days, na.rm = TRUE)

national_median <- data_for_plot %>%
  group_by(Nationality) %>%
  summarize(med = median(n_days, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(med_label = glue("Median days: {med}"))

data_for_plot %>%
  filter(n_days <= 365) %>%
  ggplot() +
  geom_histogram(aes(n_days, fill = color_route),
                 binwidth = HIST_BINWIDTH
                 ) +
  geom_vline(data = national_median,
             aes(xintercept = med)
             ) +
  scale_x_continuous(breaks = 90 * (1:8)) +
  scale_y_continuous(labels = label_number_si()) +
  geom_text(data = national_median,
            aes(x = med + 10, y = 5000, label = med_label), 
            # aes(x = 300, y = 5000, label = med_label), hjust = 1
            hjust = 0
            ) +
  scale_fill_identity(labels = str_to_title(color_routes$Nationality),
                         breaks = color_routes$color_route,
                         guide = "legend"
                      ) +
  facet_wrap(~Nationality) +
  theme(legend.position = "none") +
  labs(title = "Duration of voyages",
       subtitle = glue("In {HIST_BINWIDTH}-day bins. Overall median: {my_median} days.",
                       "\nShowing voyages less than 1 year in duration."),
       caption = my_caption)

```

<br>

>Wind to a sailor is what money is to life on shore. <br>
>--Sterlin Hayden

<br>

There was great variability in the distance ships traveled in a day. In addition to differences in ships' designs and the degree to which their bottoms were foul with marine growth, sometimes the winds didn't blow or blew in the wrong direction. Sometimes there wasn't a need to put sails, spars, and masts at risk to eke out all possible speed. Sometimes there just wasn't far to go.

While the wind can be capricious most anywhere, the [doldrums](https://en.wikipedia.org/wiki/Intertropical_Convergence_Zone) are justly named: ships could drift for weeks in the heat, rolling uncomfortably and running low on fresh water.

>Down dropt the breeze, the sails dropt down,<br>
>'Twas sad as sad could be;<br>
>And we did speak only to break<br>
>The silence of the sea!<br>
>
>All in a hot and copper sky,<br>
>The bloody Sun, at noon,<br>
>Right up above the mast did stand,<br>
>No bigger than the Moon.<br>
>
>Day after day, day after day,<br>
>We stuck, nor breath nor motion;
>As idle as a painted ship<br>
>Upon a painted ocean.<br>
>
>Water, water, every where,<br>
>And all the boards did shrink;<br>
>Water, water, every where,<br>
>Nor any drop to drink.<br>

From *The Rime of the Ancient Mariner*, by Samuel Taylor Coleridge

    
At other times the wind was just right, and life was easy--or at least easier.

>The fair breeze blew, the white foam flew,<br>
>The furrow followed free:<br>
>We were the first that ever burst<br>
>Into that silent sea.<br>

From *The Rime of the Ancient Mariner*, by Samuel Taylor Coleridge


Even so, the distribution of distances traveled per day is remarkably similar:

<br>

```{r plot-distance-histogram, out.width="80%"}

HIST_BINWIDTH <- 20 # km

data_for_plot <- df_voyages %>%
  mutate(Nationality = str_to_title(Nationality)) %>%
  # not enough data for these countries to include them in the histogram
  filter(!Nationality %in% c("American", "Danish", "Hamburg", "Swedish")) %>%
  # account for missing log entries in distance
  filter(!days_since_last_obs > 1)

my_median <- median(data_for_plot$distance_km, na.rm = TRUE)

national_median <- data_for_plot %>%
  group_by(Nationality) %>%
  summarize(med = median(distance_km, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(med_label = glue("Median km: {med}"))

data_for_plot %>%
  filter(
    distance_km <= 600,
    n_days <= 365) %>% # should we also filter more finely than 1000 km?
  ggplot() +
  geom_histogram(aes(distance_km, fill = color_route),
                 binwidth = HIST_BINWIDTH
                 ) +
  geom_vline(data = national_median,
             aes(xintercept = med)
             ) +
  scale_y_continuous(labels = label_number_si(accuracy = 1)) +
  scale_fill_identity(labels = str_to_title(color_routes$Nationality),
                         breaks = color_routes$color_route,
                         guide = "legend"
                      ) +
  facet_wrap(~Nationality, scales = "free_y") +
  theme(legend.position = "none") +
  labs(title = "Distance traveled in 24-hour periods",
       subtitle = glue("In {HIST_BINWIDTH} km bins. Median: {round(my_median, 0)} km"),
       caption = my_caption)

```

<br>

Journeys of longer duration in this data set typically include gaps in the observation dates without increases in distance as seen in the plot of British ships below. These horizontal lines indicate time in port, or less likely: side trips missing in the logs. I will assume time in port.

<br>

```{r plot-distance-lineplot, out.width="80%"}
#fig.height=5

DURATION_CUTOFF_DAYS <- 365

data_for_plot <- df_voyages %>%
  mutate(voyage_id = paste0(ShipName, "-", VoyageIni),
         Nationality = str_to_title(Nationality) 
         ) %>%
  # not enough data for these countries to include them in the histogram
  # filter(!Nationality %in% c("American", "Danish", "Hamburg", "Swedish")) %>%
  filter(Nationality == "British")

data_for_plot %>%
    filter(days_enroute < 365) %>% # should we also filter more finely than 1000 km?
    ggplot() +
    geom_line(aes(x = days_enroute, y = cum_distance, group = voyage_id),
              size = 0.1, alpha = 0.9, show.legend = FALSE, color = "black"
    ) +
    geom_point(aes(x = days_enroute, y = cum_distance, color = color_route, group = voyage_id), 
               size = 0.1, alpha = 0.2
    ) +
    scale_y_continuous(labels = label_number_si(accuracy = 1)) +
    scale_color_identity(labels = str_to_title(color_routes$Nationality),
                           breaks = color_routes$color_route,
                           guide = "legend"
                        ) +
    facet_wrap(~Nationality) +
    guides(color = guide_legend(override.aes = list(size=4))) +
    theme(legend.position = "none") +
    labs(title = glue("Distance {str_to_title(data_for_plot$Nationality)} ships traveled day-by-day"),
         subtitle = glue("Showing less than {DURATION_CUTOFF_DAYS} days en route",
                         "\nHorizontal lines indicate time in port"),
         caption = my_caption)
  
# Not using the following to create four plots ; this is not important enough to spend four plots on it
# 
# plot_distance_day_by_day<- function(nationality = NA) {
#   
#   p <- data_for_plot %>%
#     filter(days_enroute < 365) %>% # should we also filter more finely than 1000 km?
#     filter(Nationality %in% nationality) %>%
#     ggplot() +
#     geom_line(aes(x = days_enroute, y = cum_distance, group = voyage_id),
#               size = 0.1, alpha = 0.9, show.legend = FALSE, color = "black"
#     ) +
#     geom_point(aes(x = days_enroute, y = cum_distance, color = color_route, group = voyage_id),
#                size = 0.1, alpha = 0.2
#     ) +
#     scale_y_continuous(labels = label_number_si(accuracy = 1)) +
#     scale_color_identity(labels = str_to_title(color_routes$Nationality),
#                            breaks = color_routes$color_route,
#                            guide = "legend"
#                         ) +
#     # facet_wrap(~Nationality) + #, scales = "free_y"
#     guides(color = guide_legend(override.aes = list(size=4))) +
#     theme(legend.position = "none") +
#     labs(title = glue("Distance {str_to_title(nationality)} ships traveled day-by-day"),
#          subtitle = glue("Showing less than {DURATION_CUTOFF_DAYS} days en route",
#                          "\nHorizontal lines indicate time in port"),
#          caption = my_caption)
#   
#   print(p)
#   
# }
# 
# walk(str_to_upper(sort(unique(data_for_plot$Nationality))), 
#      plot_distance_day_by_day)

```

<br>

The British and Dutch ships spent proportionally longer in port. This dynamic could have been due to the need for repairs after a trip around the South African cape, or possibly it could be a willingness to station a ship at a port for longer periods of time.

<br>

```{r plot-days-missing-ecdf, out.width="80%", warning=FALSE}

CUTOFF_DAYS <- 90

data_for_plot <- df_voyages %>%
  mutate(Nationality = str_to_title(Nationality)) %>%
  # not enough data for these countries to include them in the histogram
  filter(!Nationality %in% c("American", "Danish", "Hamburg", "Swedish")) %>%
  filter(days_since_last_obs > 1)

my_median <- median(data_for_plot$days_since_last_obs, na.rm = TRUE)

national_median <- data_for_plot %>%
  group_by(Nationality) %>%
  summarize(med = median(days_since_last_obs, na.rm = TRUE)) %>%
  ungroup() %>%
  mutate(med_label = glue("Median days: {med}"))

n_excluded <- data_for_plot %>% filter(days_since_last_obs > CUTOFF_DAYS) %>% nrow()

data_for_plot %>%
  ggplot(aes(days_since_last_obs, color = color_route)) +
  stat_ecdf(geom = "line", pad = FALSE,
         size = 1, alpha = 0.8) +
  scale_x_continuous(breaks = 30*(0:6), limits = c(0, CUTOFF_DAYS)) +
  scale_y_continuous(labels = percent_format()) +
  scale_color_identity(labels = str_to_title(color_routes$Nationality),
                         breaks = color_routes$color_route,
                         guide = "legend"
                      ) +
  theme(legend.position = "right") +
  labs(title = "Times in port",
       y = "Cumulative pct of gaps in logs",
       subtitle = glue("{nrow(data_for_plot)} gaps in logs of a day or more",
       " ({round(100 * nrow(data_for_plot) / nrow(df_voyages), 2)}% of log entries)",
       "\nMedian days: {round(my_median, 0)} days; not showing {n_excluded} gaps > {CUTOFF_DAYS} days"),
       color = NULL,
       caption = my_caption)

```

<br>

### Countries

After counting the countries of the origin and destination, I offer these observations:

* The major colonial powers are well represented, as are locations of principal bases and colonies, the latter including India, Uruguay (location of Montevideo and the River Plate), South Africa (key colony and port at the Cape for British and Dutch at different times), 
* Islands are of far greater importance and familiarity to sailors than to the rest of us, and there sure are a lot of them.

<br>

```{r plot-country_barchart, fig.height = 5, out.width="80%"}

data_for_plot <- df_voyages %>%
  distinct(ShipName, VoyageIni, .keep_all = TRUE) %>%
  mutate(country = glue("{country_from} : {country_to}")) %>%
  separate_rows(country, sep = " : ") %>%
  count(country) %>%
  mutate(country_trunc = str_extract(country, "^\\s*(?:\\S+\\s+){0,2}\\S+"),
         grouping = cut(n, breaks = c(0, 40, 1500),
                        right = TRUE,
                        labels = c("10-40", "40+"))
  )

data_for_plot <- df_voyages %>%
  distinct(ShipName, VoyageIni, .keep_all = TRUE) %>%
  mutate(country = glue("{country_from} : {country_to}")) %>%
  separate_rows(country, sep = " : ") %>%
  count(country) %>%
  mutate(country_trunc = str_extract(country, "^\\s*(?:\\S+\\s+){0,2}\\S+"),
         grouping = cut(n, breaks = c(0, 30, 100, 1500),
                        right = TRUE,
                        labels = c("10-30", "31-100", "101+"))
  )

data_for_plot %>%
  filter(n >= 10,
         country_trunc != "NA") %>%
  mutate(country_trunc = fct_reorder(country_trunc, n)) %>%
  ggplot() +
  geom_col(aes(x = n, y = country_trunc),
           fill = "light slate gray", alpha = 0.8) +
  scale_x_continuous(labels = label_number_si()) +
  facet_wrap(~ grouping, nrow = 1, scales = "free") +
  theme(legend.position = "none") +
  labs(title = "Countries: Count of mentions",
       subtitle = "Port of departure or arrival; 10 or more mentions",
       y = "country",
       caption = my_caption)

```

<br>

### About the data set

Each row of data ("record") in the data set corresponds to one observation, typically:

* Made at noon local time, recording location (lat/lon) and weather conditions
* One observation each day of the voyage, except when a ship stays in port

I filtered out the following records:

* Voyages less than `r MIN_VOYAGE_DURATION` days or greater than 2 years, since both cases are likely data errors
* Records missing latitude, longitude, or the date of observation
* Voyages starting earlier than 1750 or later than 1815 (start date is recorded in `VoyageIni`)
* Voyages with a gap of missing dates a year or longer in duration
* Multiple observations on the same day by the same ship (uniquely identified by `ShipName` and `VoyageIni`)
* Single data points that were more than 1000 km from the previous data point, which removed some erroneous data

Where there are straight lines in the plotted tracks we can infer there are missing records.

It's worth noting some other considerations:

* Some logbooks include stops in multiple ports as part of a single voyage. Others break a long journey into multiple voyages (a voyage being defined as a unique combination of `ShipName` and `VoyageIni` voyage start date; each voyage has a `VoyageFrom` and `VoyageTo`, and for most I manually normalized port names in `port_from` and `port_to`) and added `country_from` and `country_to`.

* We don't know how these particular logbooks were chosen, so it's best to assume we have a convenience sample, which limits the kinds of inferences and generalizations we can make.

* It's not possible to determine from the data set alone when multiple ships share the same name. Typically names are not in use concurrently within one country or company, however it's not uncommon for a name to be revived some years after the demise of previous ship of that name.

* I refer to colonies and countries by their current name in English. In cases of cities and geographic entities (capes, points, bays, rivers) being part of the origin or destination, I generally use current names, except where old names are very well known (for example, Bombay, Madras, Calcutta all have new names, which I didn't use). In some cases I substitute a larger city very close to the small city or fort (for example, Middelburg instead of Vlissingen and Rammekens), and in some cases I have kept the French or Spanish name. I determined the "normalized" port names and added countries by inspecting the port names, plotting the routes, and triangulating via Wikipedia, Google Maps, and Google search. It's possible a small minority of my inferences are incorrect.

* While the motivation and funding for digitizing these logs was to make weather data available for analysis, I'm ignoring that and focusing on the voyage tracks.

Even with these considerations there is a lot we can learn by plotting the locations recorded each day, which reveals the track of each voyage within the limits of accuracy available at the time with a [sextant](https://en.wikipedia.org/wiki/Sextant), [marine chronometer](https://en.wikipedia.org/wiki/Marine_chronometer), and [alamanac.](https://en.wikipedia.org/wiki/Nautical_almanac)--or when the weather did not cooperate, by [dead reckoning](https://en.wikipedia.org/wiki/Dead_reckoning).

<br>

## Maps: North Atlantic and Northwest America

### Voyages to or from Virginia ("Hampton Road")

British ships made most of the voyages to Virginia in this data set; Dutch ships made a couple. We see a pattern in the routes between the Mid-Atlantic coast and Northern Europe, due to the [prevailing winds](https://en.wikipedia.org/wiki/Prevailing_winds): when leaving Europe, south near the Azores or Canary Islands then west across the Atlantic; when leaving North America: a more northerly path. 

For tabular data see [Hampton Road]

<br>

```{r hampton-road, out.width="100%", echo = TRUE}
voyage_list <- df_voyages %>% 
               filter(port_from == "hampton road" | port_to == "hampton road")

plot_voyages(ships = voyage_list$ShipName,
             from = "hampton road",
             to = "hampton road"
)
```

<br>

Looking at the same voyages by year, we see nearly the whole time period represented; only the 1780s are missing.

<br>

```{r hampton-road-by-year, out.width="100%", echo = TRUE}
plot_voyages(ships = voyage_list$ShipName,
             from = "hampton road",
             to = "hampton road",
             color_var = "year"
)

```

<br>

### Voyages between US and Netherlands

Our data set includes Dutch voyages from Boston, New York, and Virginia. All occurred after US independence--the first one directly after.

Also see table at [US and Netherlands].

<br>

```{r between-us-netherlands, out.width="100%", echo = TRUE}

ship_list <- 
  c(df_voyages %>% 
      filter(country_from == "united states" & country_to == "netherlands") %>%
      pull(ShipName),
    df_voyages %>%
      filter(country_from == "netherlands" & country_to == "united states") %>%
      pull(ShipName)
  )

plot_voyages(ships = ship_list)
plot_voyages(ships = ship_list,
             color_var = "year")

```

<br>

### Voyages between US and France

These voyages occurred in the final months of the American Revolutionary War in 1783 and afterwards.

<br>

```{r between-us-france, out.width="100%", echo = TRUE}

ship_list <- 
  c(df_voyages %>% 
      filter(country_from == "united states" & country_to == "france") %>%
      pull(ShipName),
    df_voyages %>%
      filter(country_from == "france" & country_to == "united states") %>%
      pull(ShipName)
  )

plot_voyages(ships = ship_list)

plot_voyages(ships = ship_list,
             color_var = "year")

```

<br>

### Voyages between Canada and France

Most French voyages occurred before or during the [Seven Years War](https://en.wikipedia.org/wiki/Seven_Years%27_War), after which France's territorial holdings in North America were limited to the small islands of [St Pierre and Miquelon](https://en.wikipedia.org/wiki/Saint_Pierre_and_Miquelon), which remain a part of France today.

See also table [Canada and France]

<br>

```{r between-canada-france_year, out.width="100%", echo = TRUE}

ship_list <- 
  c(df_voyages %>% 
      filter(country_from == "canada" & country_to == "france") %>%
      pull(ShipName),
    df_voyages %>%
      filter(country_from == "france" & country_to == "canada") %>%
      pull(ShipName)
  )

plot_voyages(ships = ship_list,
             color_var = "year")

```

<br>

### Voyages to or from Florida

[St. Augustine](https://en.wikipedia.org/wiki/St._Augustine,_Florida) was founded in 1565 by Spanish explorers and has been inhabited continuously since then--the longest of any city in the continental US. It became the capital of British East Florida in 1763, returned to Spanish control in 1783, then Spain ceded it to the USA in 1819. Our data set includes only British voyages.

Also see table [Florida].

<br>

```{r florida-year, out.width="100%", echo = TRUE}

plot_voyages(
  from = filter(df_ports, level2 == "florida") %>% pull(port2),
  to = filter(df_ports, level2 == "florida") %>% pull(port2),
  color_var = "year"
)

```

<br>

```{r}
voyage_list <- df_voyages %>% 
               filter(str_detect(port_to, "florida") | str_detect(port_from, "florida"))
```

### All voyages of ships that went to to or from Florida at least once

Looking at all the voyages in our data set undertaken by ships that traveled from or to Florida, we see a much wider web going as far as India, Ceylon (now Sri Lanka), Malaysia, and the Dutch East Indies (now Indonesia and nearby island nations). These `r nrow(distinct(voyage_list, ShipName))` ships were part of the British Royal Navy.

<br>

```{r florida2-year, out.width="100%", echo = TRUE}

plot_voyages(ships = voyage_list$ShipName,
             color_var = "year")

```

<br>

### Explorations of the northwest coast of North America

Our data set includes Spanish, British and French voyages of discovery along the western coast of North America. The Spanish went further south; the British, further north.

* The historic [La Boussole](https://en.wikipedia.org/wiki/French_ship_Boussole_(1781)) ("the compass") captained by [Jean-François de Galaup, comte de Lapérouse](https://en.wikipedia.org/wiki/Jean-François_de_Galaup,_comte_de_Lapérouse), which disappeared after leaving Botany Bay in 1788.
* The first [HMS Queen Charlotte](https://en.wikipedia.org/wiki/HMS_Queen_Charlotte), launched in 1790 and sank in 1800.
* The Spanish [Aranzazu](https://text-message.blogs.archives.gov/2017/10/19/establishing-and-disbanding-the-neah-bay-settlement-1792/) which was looking for the rumored northwest passage. For more background to Spanish aims, activities, and rivalry with the British in the American Northwest, see [here]( https://text-message.blogs.archives.gov/2017/10/12/225-years-ago-spanish-explorations-of-the-pacific-northwest-and-the-first-spanish-settlement-in-washington-state-nunez-gaona-neah-bay-1792-part-ii-spanish-explorations-of-the-pacific-northwest-a/).

See also table [Northwest America]

<br>

```{r nw-na, out.width="100%", echo = TRUE}

nw_explorers <- 
  get_voyage_details(range_lon = c(-170, -100),
                     range_lat = c(15, 90)
                     )

plot_voyages(ships = nw_explorers$ShipName,
             range_lon = c(-170, -100),
             range_lat = c(15, 90)
)

plot_voyages(ships = nw_explorers$ShipName,
             range_lon = c(-170, -100),
             range_lat = c(15, 90),
             color_var = "year")

```

<br>

### James Cook's first and second voyages of discovery

Our data set includes portions of [James Cook's](https://en.wikipedia.org/wiki/James_Cook) first circumnavigation westward for the purpose of observing the [1769 transit of Venus in Tahiti](https://en.wikipedia.org/wiki/1769_transit_of_Venus_observed_from_Tahiti) and then searching for unknown land to the south, [Terra Astralis, Incognita](https://en.wikipedia.org/wiki/Terra_Australis), believed to exist further south than Australia, which was then called New Holland. On this journey he landed in Australia at a place he named [Botany Bay](https://en.wikipedia.org/wiki/Botany_Bay) in present-day Sydney. Our records include portions of Cook's second voyage from Britain eastward to New Zealand and eventually around the South American cape and back to Britain. He never found Antarctica, despite coming close, and his experience convinced people that Terra Astralis, Incognita did not exist.

See also table [James Cook's journeys]

<br>

```{r cook, out.width="100%", echo = TRUE}

ship_list <- c("ENDEAVOUR", "RESOLUTION")
cooks_first_journey <- c("1768-01-01", "1771-12-31")
cooks_second_journey <- c("1772-01-01", "1775-12-31")

plot_voyages(ships = ship_list,
             range_dates = cooks_first_journey,
             color_var = "year"
)

plot_voyages(ships = ship_list,
             range_dates = cooks_second_journey,
             color_var = "year"
)

```

## Maps: South America

### To and or from Brazil, Uruguay, Argenina

Most voyages in our data from or to South America we between to [Montevideo](https://en.wikipedia.org/wiki/Montevideo) and Spanish ports. Montevideo was Spain' primary naval base in this period. The trade from the interior via the [Río de la Plata](https://en.wikipedia.org/wiki/R%C3%ADo_de_la_Plata) (River Plate) passed through Montevideo or [Buenos Aires](https://en.wikipedia.org/wiki/Buenos_Aires), which sits on the opposite coast of the estuary.

At least some of the British voyages likely contributed to the [Battle of Montevideo (1807)](https://en.wikipedia.org/wiki/Battle_of_Montevideo_(1807)) or its aftermath, when the British captured and held Montevideo for much of that year.

The voyages to or from Spain occurred before or during the 1780s--well before British blockades of [Spanish ports](https://en.wikipedia.org/wiki/Cádiz) 1797-1893 and 1803-1808.

To:

<br>

```{r to-sa, out.width="100%", echo = TRUE}

plot_voyages(to = df_voyages %>% 
      filter(country_to %in% c("brazil", "uruguay", "argenina" ))  %>%
      pull(port_to)
      )

plot_voyages(to = df_voyages %>% 
      filter(country_to %in% c("brazil", "uruguay", "argenina" ))  %>%
      pull(port_to),
      color_var = "year"
      )

```

<br><

From:

br>

```{r from-sa, out.width="100%", echo = TRUE}

plot_voyages(from = df_voyages %>% 
      filter(country_from %in% c("brazil", "uruguay", "argenina" ))  %>%
      pull(port_from)
      )

plot_voyages(from = df_voyages %>% 
      filter(country_from %in% c("brazil", "uruguay", "argenina" ))  %>%
      pull(port_from),
      color_var = "year"
      )

```

<br>

### The challenge of rounding the Horn traveling west

The track of the french ship La Boussole illustrates the difficulty [square-rigged](https://en.wikipedia.org/wiki/Square_rig) ships faced from storms and contrary winds.

```{r from-sa-horn, out.width="100%", echo = TRUE}

plot_voyages(from = df_voyages %>% 
      filter(country_from %in% c("brazil"),
             Nationality == "FRENCH")  %>%
      pull(port_from),
      ships = "LA BOUSSOLE"
      )

```

<br>

## Maps: African Guinea

### Triangular trade

```{r}
guinea_coast <- c("senegal", "guinea-bissau", "guinea", "sierra leone", "liberia", "ivory coast", "ghana", "togo", "benin", "nigeria", "cameroon", "equatorial guinea", "gabon")
```


In our data set: Dutch and British voyages before 1780 to [Guinea](https://en.wikipedia.org/wiki/Guinea_(region)), modern day `r glue_collapse(str_to_title(guinea_coast), sep = ", ", last = " and ")`. Most voyages were to/from slave trading posts or colonial fortresses. We see two parts of the [triangular trade](https://en.wikipedia.org/wiki/Triangular_trade) route: from Europe to Guinea, then to the Americas.

<br>

```{r to-guinea-coast, out.width="100%", echo = TRUE}

plot_voyages(to = df_voyages %>% 
      filter(country_to %in% guinea_coast)  %>%
      pull(port_to),
      range_lat = c(20, -35)
      )

plot_voyages(to = df_voyages %>% 
      filter(country_to %in% guinea_coast)  %>%
      pull(port_to),
      range_lat = c(20, -35),
      color_var = "year"
      )

```

<br>

```{r from-guinea-coast, out.width="100%", echo = TRUE}

plot_voyages(from = df_voyages %>% 
      filter(country_from %in% guinea_coast)  %>%
      pull(port_from),
      range_lat = c(20, -35)
      )

plot_voyages(from = df_voyages %>% 
      filter(country_from %in% guinea_coast)  %>%
      pull(port_from),
      range_lat = c(20, -35),
      color_var = "year"
      )

```

<br>

## Maps: India and Indonesia

### To and from Penang, Malaysia

Our data set includes 28 voyages to or from Penang. There are just enough to see patterns in the routes: leaving the UK for Malaysia, ships stayed near Africa, veered toward Brazil, then picked up the prevailing westerlies between 50 and 60 degrees South, perhaps taking advantage of the [Antarctic Circumpolar Current](https://en.wikipedia.org/wiki/Antarctic_Circumpolar_Current) as well.

<br>

```{r to-penang, out.width="100%", echo = TRUE}

plot_voyages(to = "penang")

```

<br>

In contrast, when traveling the other direction, captains minimized the time they faced the prevailing westerlies, just barely rounding the Cape, then traveling much further into the north Atlantic before turning towards the UK.

<br>

```{r from-penang, out.width="100%", echo = TRUE}

plot_voyages(from = "penang")

```

<br>

### To and from India

This pattern is clearer still the tracks to and from India.

<br>

```{r to-india, out.width="100%", echo = TRUE}

plot_voyages(to = df_voyages %>%
               filter(country_to == "india") %>%
               pull(port_to)
)

plot_voyages(to = df_voyages %>%
               filter(country_to == "india") %>%
               pull(port_to),
             color_var = "year"
)

```

<br>

From India

```{r from-india, out.width="100%", echo = TRUE}

plot_voyages(from = df_voyages %>%
               filter(country_from == "india") %>%
               pull(port_from)
)

```

<br>

### To and from Indonesia

The same pattern is largely true for ships going to and from Indonesia. Most were Dutch; the main difference in their route was staying near 60 degrees South longer 

```{r to-indonesia, out.width="100%", echo = TRUE}

plot_voyages(to = df_voyages %>%
               filter(country_to == "indonesia") %>%
               pull(port_to)
)

plot_voyages(to = df_voyages %>%
               filter(country_to == "indonesia") %>%
               pull(port_to),
             color_var = "year"
)

```

<br>

From Indonesia

```{r from-indonesia, out.width="100%", echo = TRUE}

plot_voyages(from = df_voyages %>%
               filter(country_from == "indonesia") %>%
               pull(port_from)
)

plot_voyages(from = df_voyages %>%
               filter(country_from == "indonesia") %>%
               pull(port_from),
             color_var = "year"
)

```
<br>

### The Importance of Chronometers

Perhaps you've noticed the unlikely number of horizontal tracks, for example, above when leaving Jakarta and traveling to western India or Yemen or ships approaching St Helena from the East. Ships would round the Cape and find the right latitude well to the east of St Helena. Then they could sail directly west to the island. Why? Because it's hard to find a small island in a big ocean, and until there were sufficiently accurate chronometers, it was much easier to calculate an accurate latitude than longitude. In the period of this data set, chronometer technology improved a lot, and one can see in the trend towards lesser safety margin in later years.  

<br>

```{r chronometers-st-helena, out.width="100%", echo = TRUE}

voyage_list <- df_voyages %>%
               filter(country_from == "india" & port_to == "st helena")

plot_voyages(ships = voyage_list$ShipName,
             from = voyage_list$port_from,
             to = "st helena", 
             range_lon = c(-10, 60),
             range_lat = c(5, -55),
             color_var = "year"
)

```

<br>

## Selected data tables

### Hampton Road

Voyages to/from Hampton Roads ("hampton road") in table form. Column names are a subset of the variables in the data frame I used for plotting. Ones with capital letters were in the original data set; I added the ones in lower case.

<br>

```{r hampton-road-by-year-table, out.width="100%", echo = TRUE}

voyage_list <- df_voyages %>% 
               filter(port_from == "hampton road" | port_to == "hampton road")

summarize_voyages(ships = voyage_list$ShipName,
                  from = "hampton road",
                  to = "hampton road"
) %>% 
  as_raw_html()

```

<br>

### US and Netherlands

```{r, out.width="100%", echo = TRUE}
ship_list <- 
  c(df_voyages %>% 
      filter(country_from == "united states" & country_to == "netherlands") %>%
      pull(ShipName),
    df_voyages %>%
      filter(country_from == "netherlands" & country_to == "united states") %>%
      pull(ShipName)
  )

summarize_voyages(ships = ship_list) %>%
  as_raw_html()

```

<br>

### Canada and France

```{r between-canada-france-year-table, out.width="100%", echo = TRUE}

ship_list <- 
  c(df_voyages %>% 
      filter(country_from == "canada" & country_to == "france") %>%
      pull(ShipName),
    df_voyages %>%
      filter(country_from == "france" & country_to == "canada") %>%
      pull(ShipName)
  )

summarize_voyages(ships = ship_list) %>%
  as_raw_html()

```

<br

### Florida

Summary:

<br>

```{r florida-table, out.width="100%", echo = TRUE}
voyage_list <- df_voyages %>% 
  filter(str_detect(port_to, "florida") | str_detect(port_from, "florida"))

summarize_voyages(ships = voyage_list$ShipName,
                  from = c("florida", "cape florida", "florida bay"),
                  to = c("florida", "cape florida", "florida bay")
) %>% 
  as_raw_html()

```

<br>

### Northwest America

```{r nw-na-table, out.width="100%", echo = TRUE}

nw_explorers <- 
  get_voyage_details(range_lon = c(-170, -100),
                     range_lat = c(15, 90)
                     )

summarize_voyages(ships = nw_explorers$ShipName,
                  range_lon = c(-170, -100),
                  range_lat = c(15, 90),
) %>%
  as_raw_html()

```

<br>

### James Cook's journeys

```{r cook-table, out.width="100%", echo = TRUE}

ship_list <- c("ENDEAVOUR", "RESOLUTION")
cooks_journeys <- c("1768-01-01", "1774-12-31")

summarize_voyages(ships = ship_list,
                  range_dates = cooks_journeys
) %>%
  as_raw_html()

```

<br>

## Notes

### Acknowledgements

I was inspired by Simon Coulombe's write up: [Animated map of ships, 1750-1799](https://www.simoncoulombe.com/2020/11/animated-ships/) which makes use of the [Climatological Database for the World’s Oceans (CLIWOC)](https://www.historicalclimatology.com/cliwoc.html)

>The Climatological Database for the World's Oceans (CLIWOC) represents the culmination of a major project funded by the European Union, and pursued by a large team of researchers in organizations and universities around the world. 
> ...
> You can read more about how the database was originally coded, and has now been reformatted, at Steven's [website](https://stvno.github.io/page/cliwoc/). This is essential reading if you'd like to use the database for climate history research. 
>
> To interpret nautical terms in the database, you will likely need to use a [dictionary](https://www.historicalclimatology.com/uploads/4/5/1/4/4514421/cliwoc_nautical_terms.pdf) created as part of the CLIWOC project. 

I could have got the data from source at https://www.historicalclimatology.com/cliwoc.html; however Simon offers a download that is already cleaned up a bit:

* https://blogsimoncoulombe.s3.amazonaws.com/cliwoc/cliwoc21.csv

I referred a lot to the codebook at https://stvno.github.io/page/cliwoc/

Thanks to the EU for funding the digitization and to everyone who did the work to get the data in a state that made my task so easy. And thanks to Claus Wilke for providing the code pattern for plotting a globe with simple features (sf R package), which Simon and I both followed.

Adrien Charles (and others?) at Axxio made a nice visualization in Tableau here: https://www.axxio.io/the-age-of-discovery/ , and there are other examples a web search away. I did not consult them.

<br>

### Possible improvements

I could do some of the following:

* Look at duration, distance, and time in port by company; currently I'm only looking at it by nationality
* Look at areas for differences in average velocity or distribution of velocities
* Look at differences in average duration or in opposite directions between the same ports
* Look at changes in durations or routes from the early years to the later years, e.g., British and Dutch journeys from Jakarta to a UK or Dutch port, respectively

<br>
<br>

---

By Daniel Moul (heydanielmoul via gmail)

![CC-BY](https://i.creativecommons.org/l/by/4.0/88x31.png) This work is licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/)



